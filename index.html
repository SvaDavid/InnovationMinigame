<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Innovation Minigame</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase App (dělejte to jen jednou) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyB2CT9J8c6d4RUCQTV63aerPWRZ__T8R5E",
            authDomain: "innovation-minigame.firebaseapp.com",
            databaseURL: "https://innovation-minigame.firebaseio.com",
            projectId: "innovation-minigame",
            storageBucket: "innovation-minigame.appspot.com",
            messagingSenderId: "1234567890",
            appId: "1:1234567890:web:abcdef123456",
            measurementId: "G-2K8YQMLJ44"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        var database = firebase.database();
    </script>
</head>
<body>
    <div class="container">
        <div class="main-window">
            <h1>Innovation Minigame</h1>
            <!-- Formulář pro zadání názvu nápadu a jména hráče -->
            <form id="inputForm">
                <label for="ideaName">Název nápadu:</label>
                <input type="text" id="ideaName" name="ideaName" required>

                <label for="playerName">Vaše jméno:</label>
                <input type="text" id="playerName" name="playerName" required>

                <button type="submit">Ďalej</button>
            </form>

            <!-- Formulář pro hodnocení nápadu (skrytý na začátku) -->
            <form id="ratingForm" style="display: none;">
                <div class="column">
                    <!-- Skupina Market -->                
                    <h2>Market</h2>
                    <label for="scalability">Scalability:</label>
                    <select id="scalability" name="scalability">
                        <option value="1">Not scalable, internal efficiency for company-wide use</option>
                        <option value="2">Product/service for selected types of clients in domestic market</option>
                        <option value="3">Scalable solution for both clients and non-clients in local market</option>
                        <option value="4">Scalable solution with potential to enter the european market</option>
                        <option value="5">Globally scalable solution with potential to explore new markets</option>
                    </select>

                    <label for="acquisition">Acquisition Potential:</label>
                    <select id="acquisition" name="acquisition">
                        <option value="1">No direct acquisition potential, but internal efficiency</option>
                        <option value="2">Product/service for existing group of TB/RB clients</option>
                        <option value="3">Solution with potential to acquire new SK clients</option>
                        <option value="4">Solution with a significant acquisition potential within the SK</option>
                        <option value="5">White-label solution with huge global acquisition potential</option>
                    </select>

                    <label for="originality">Originality:</label>
                    <select id="originality" name="originality">
                        <option value="1">The innovation exist in some form in the domestic market</option>
                        <option value="2">Adjacent idea not present in SK market, but in CEE probably yes</option>
                        <option value="3">Adjacent innovation which is not widespread in the CEE market</option>
                        <option value="4">Disruptive idea following the global market trends</option>
                        <option value="5">Disruptive innovation with a potential to transform the industry</option>
                    </select>

                    <label for="marketRelevance">Market relevance:</label>
                    <select id="marketRelevance" name="marketRelevance">
                        <option value="1">Innovation idea with no significant impact on the market</option>
                        <option value="2">Exploit the existing demand (red ocean) with many competitors</option>
                        <option value="3">Idea with a potential of shifting from red to blue ocean</option>
                        <option value="4">Explore idea creating and capturing a new demand (blue ocean)</option>
                        <option value="5">Idea has a game-changing potential to transform the market</option>
                    </select>
                </div>
                <div class="column">
                <!-- Skupina Feasibility -->
                    <h2>Feasibility</h2>
                    <label for="techEconomic">Tech & Economic:</label>
                    <select id="techEconomic" name="techEconomic">
                        <option value="1">Robust solution very difficult and expensive to develop</option>
                        <option value="2">Expensive to develop, but feasible from tech. Point of view</option>
                        <option value="3">Medium investment with straightforward tech. Development</option>
                        <option value="4">Low fin. resources required and development is relatively feasible</option>
                        <option value="5">Easy to develop, no issues from fin./tech. Point of view</option>
                    </select>

                    <label for="capacityRequired">Capacity Required:</label>
                    <select id="capacityRequired" name="capacityRequired">
                        <option value="1">Over 5 teams need to be included together with external parties</option>
                        <option value="2">Over 5 teams are required to work on the solution in-house</option>
                        <option value="3">Medium capacity required, 3-5 teams could deliver the solution</option>
                        <option value="4">Little capacity required, 1-2 teams needed to deliver the solution</option>
                        <option value="5">Couple of employees can completely deliver the idea</option>
                    </select>

                    <label for="integration">Integration:</label>
                    <select id="integration" name="integration">
                        <option value="1">Not possible to integrate to current bank´s products and systems</option>
                        <option value="2">Integration would be difficult and requires new integration layers</option>
                        <option value="3">Possible to integrate using bank´s existing integration layers</option>
                        <option value="4">Possible to integrate into current bank´s products and systems</option>
                        <option value="5">Integration would be easy and clear using existing systems</option>
                    </select>
                </div>
                <div class="column">
                <!-- Skupina Impact -->
                    <h2>Impact</h2>
                    <label for="easeOfOperations">Ease of Operations:</label>
                    <select id="easeOfOperations" name="easeOfOperations">
                        <option value="1">Many adjustments required with a complicated maintenance</option>
                        <option value="2">The solution requires a lot of ongoing adjustments</option>
                        <option value="3">Solution is easy to operate, with standard level of maintenance</option>
                        <option value="4">Stable solution, only a few adjustments needed in the future</option>
                        <option value="5">The solution is totally stable and no adjustments are needed</option>
                    </select>

                    <label for="savingImpact">Saving Impact:</label>
                    <select id="savingImpact" name="savingImpact">
                        <option value="1">No saving impact at all</option>
                        <option value="2">Saving impact in terms of the optimization of processes</option>
                        <option value="3">Serious saving impact in terms of financial or human capital</option>
                        <option value="4">Big saving impact (both financial and human capital) in TB</option>
                        <option value="5">Huge saving impact (fin. and human capital) on group level</option>
                    </select>

                    <label for="strategicFit">Strategic Fit:</label>
                    <select id="strategicFit" name="strategicFit">
                        <option value="1">The solution is not in line with TB strategy</option>
                        <option value="2">Not part of the strategy, but interesting topic to consider</option>
                        <option value="3">Strategic fit and interesting topic to cover in the future</option>
                        <option value="4">Strong strategic fit and could have place on the TB roadmap</option>
                        <option value="5">The solution is totally in line with TB strategy and roadmap</option>
                    </select>
                </div>
                <div class="column">
                    <!-- Skupina Product -->
                    <h2>Product</h2>
                
                    <label for="valueAdded">Value Added:</label>
                    <select id="valueAdded" name="valueAdded">
                        <option value="1">No added value, neither for a customer, nor for an employee</option>
                        <option value="2">Novelty that brings a value to either customer or employee</option>
                        <option value="3">Relevant and meaningful value proposition to a customer</option>
                        <option value="4">Significant added value, idea aims to fulfill customer´s needs</option>
                        <option value="5">Huge added value solving the customer´s problems and needs</option>
                    </select>

                    <label for="businessImpact">Business Impact:</label>
                    <select id="businessImpact" name="businessImpact">
                        <option value="1">No business / new revenue stream potential</option>
                        <option value="2">Small potential for a new revenue stream or partnership</option>
                        <option value="3">Big potential to explore new revenue streams or partnerships</option>
                        <option value="4">Mean potential to create both new business and partnerships</option>
                        <option value="5">Huge potential to create new revenue streams & partnerships</option>
                    </select>

                    <label for="roi">ROI:</label>
                    <select id="roi" name="roi">
                        <option value="1">No ROI at all (neither profits, nor cost-savings)</option>
                        <option value="2">Potential of sufficient ROI in terms of profits or cost savings</option>
                        <option value="3">Mean level of ROI requiring adequate development costs</option>
                        <option value="4">Significant ROI in the long-term requiring high amount of costs</option>
                        <option value="5">Huge ROI with immediate effect, requiring adequate costs</option>
                    </select>

                    <label for="importance">Importance:</label>
                    <select id="importance" name="importance">
                        <option value="1">Low level of importance and priority for the bank</option>
                        <option value="2">Exciting idea, but with no significant importance for the bank</option>
                        <option value="3">Medium amount of importance, could be relevant for the bank</option>
                        <option value="4">Important solution for the bank to stay relevant in the future</option>
                        <option value="5">The idea is a must have innovation with a great importance</option>
                    </select>
                </div>

                <button id="submitRating" type="button">Ďalej</button>
            </form>

            <!-- Formulář pro výzkum (skrytý na začátku) -->
            <form id="researchForm" style="display: none;">
                <h2>Výzkum</h2>
                <div class="checkbox-group">
                    <label for="quantitative">Kvantitativní</label>
                    <input type="checkbox" id="quantitative" name="researchType" value="quantitative">
                </div>
                <div class="checkbox-group">
                    <label for="qualitative">Kvalitativní</label>
                    <input type="checkbox" id="qualitative" name="researchType" value="qualitative">
                </div>
                <div class="checkbox-group">
                    <label for="mixed">Kombinovaný</label>
                    <input type="checkbox" id="mixed" name="researchType" value="mixed">
                </div>
            
                <label for="researchTime">Čas na výzkum (hodiny): <span id="researchTimeLabel">0 MD</span></label>
                <input type="range" id="researchTime" name="researchTime" min="0" max="10" step="1" value="0">
        
                <label for="researchBudget">Rozpočet na výzkum (€): <span id="researchBudgetLabel">0€</span></label>
                <input type="range" id="researchBudget" name="researchBudget" min="0" max="30000" step="100" value="0">
            
                <button id="submitResearch" type="button">Ďalej</button>
            </form>

            <!-- Formulář pro design sprint (skrytý na začátku) -->
            <form id="designSprintForm" style="display: none;">
                <h2>Design Sprint</h2>

                <label for="designTime">Čas na design sprint (hodiny): <span id="designTimeLabel">0 MD</span></label>
                <input type="range" id="designTime" name="designTime" min="0" max="10" step="1" value="0">

                <label for="designBudget">Rozpočet na design sprint (€): <span id="designBudgetLabel">0€</span></label>
                <input type="range" id="designBudget" name="designBudget" min="0" max="30000" step="100" value="0">

                <button id="submitDesignSprint" type="button">Ďalej</button>
            </form>

            <!-- Formulář pro development (skrytý na začátku) -->
            <form id="developmentForm" style="display: none;">
                <h2>Development</h2>

                <label for="developmentTime">Čas na development (hodiny): <span id="developmentTimeLabel">0 MD</span></label>
                <input type="range" id="developmentTime" name="developmentTime" min="0" max="10" step="1" value="0">

                <label for="developmentBudget">Rozpočet na development (€): <span id="developmentBudgetLabel">0€</span></label>
                <input type="range" id="developmentBudget" name="developmentBudget" min="0" max="30000" step="100" value="0">

                <button id="submitDevelopment" type="button">Dokončit</button>
            </form>

            <!-- Část pro business case summary (skrytá na začátku) -->
            <div id="businessCaseSummary" style="display: none;">
                <h2>Business Case Summary</h2>
                <p>Celkový čas alokovaný do projektu: <span id="totalTime">0 MD</span></p>
                <p>Celkový rozpočet alokovaný do projektu: <span id="totalBudget">0€</span></p>
                <p>Očekávané výnosy: <span id="expectedRevenue">0€</span></p>
            </div>

            <!-- Část pro leaderboard -->
            <div id="leaderboard" style="display: none;">
                <h2>Leaderboard</h2>
                <table id="leaderboardTable">
                    <thead>
                        <tr>
                            <th>Jméno hráče</th>
                            <th>Název nápadu</th>
                            <th>Očekávané výnosy</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Sem budou dynamicky přidávány výsledky -->
                    </tbody>
                </table>
                <button id="resetLeaderboard">Resetovat leaderboard</button>
            </div>
        </div>
    </div>

    <!-- Přidání prvků pro zobrazení sekundárního okna (pokud je potřebné) -->
    <div id="timeCounter" style="display: none;"></div>
    <div id="budgetCounter" style="display: none;"></div>

    <script>
        let totalTime = 0;
        let totalBudget = 0;

        // Funkce pro kalkulaci očekávaných výnosů na základě hodnocení
        function calculateExpectedRevenue() {
            let scalabilityElement = document.getElementById('scalability');
            let acquisitionElement = document.getElementById('acquisition');

            if (!scalabilityElement || !acquisitionElement) {
                console.error('Scalability or acquisition element not found');
                return 0; // Nebo jiná vhodná výchozí hodnota
            }

            let scalability = parseInt(scalabilityElement.value);
            let acquisition = parseInt(acquisitionElement.value);

            // Jednoduchý příklad kalkulace výnosů na základě hodnocení (lze upravit)
            let expectedRevenue = (scalability + acquisition) * 10000; // Příklad výpočtu
            return expectedRevenue;
        }

        // Funkce pro aktualizaci času v sekundárním okně
        function updateTimeCounter(time) {
            totalTime += parseInt(time);
            let timeCounterElement = document.getElementById('timeCounter');
            if (timeCounterElement) {
                timeCounterElement.textContent = totalTime + ' MD';
            }
        }

        // Funkce pro aktualizaci financí v sekundárním okně
        function updateBudgetCounter(budget) {
            totalBudget += parseInt(budget);
            let budgetCounterElement = document.getElementById('budgetCounter');
            if (budgetCounterElement) {
                budgetCounterElement.textContent = totalBudget + '€';
            }
        }

        // Funkce pro přidání záznamu do leaderboardu a uložení do Firebase
        function addToLeaderboard(playerName, ideaName, expectedRevenue) {
            // Přidání do Firebase
            var newEntryKey = firebase.database().ref().child('leaderboard').push().key;
            firebase.database().ref('leaderboard/' + newEntryKey).set({
                playerName: playerName,
                ideaName: ideaName,
                expectedRevenue: expectedRevenue
            });
        }

        // Funkce pro načtení leaderboardu z Firebase
        function loadLeaderboard() {
            const leaderboardTable = document.getElementById('leaderboardTable').getElementsByTagName('tbody')[0];
            leaderboardTable.innerHTML = ''; // Vyčistí existující řádky

            firebase.database().ref('leaderboard').orderByChild('expectedRevenue').once('value', function(snapshot) {
                let leaderboard = [];
                snapshot.forEach(function(childSnapshot) {
                    let entry = childSnapshot.val();
                    leaderboard.push(entry);
                });

                // Seřadíme leaderboard podle očekávaného výnosu sestupně
                leaderboard.sort((a, b) => b.expectedRevenue - a.expectedRevenue);

                leaderboard.forEach(entry => {
                    const newRow = leaderboardTable.insertRow();

                    const playerNameCell = newRow.insertCell(0);
                    const ideaNameCell = newRow.insertCell(1);
                    const expectedRevenueCell = newRow.insertCell(2);

                    playerNameCell.textContent = entry.playerName;
                    ideaNameCell.textContent = entry.ideaName;
                    expectedRevenueCell.textContent = entry.expectedRevenue + '€';
                });
            });
        }

        // Funkce pro resetování leaderboardu
        function resetLeaderboard() {
            firebase.database().ref('leaderboard').remove();
            loadLeaderboard(); // Načte (prázdný) leaderboard
        }

        // Načtení leaderboardu při načítání stránky
        window.onload = function() {
            loadLeaderboard();
            document.getElementById('leaderboard').style.display = 'block';
            document.getElementById('resetLeaderboard').addEventListener('click', resetLeaderboard);
        }

        // Po odeslání formuláře pro zadání názvu nápadu a jména hráče
        document.getElementById('inputForm').addEventListener('submit', function(event) {
            event.preventDefault();
            // Skryje formulář pro zadání názvu nápadu a jména hráče
            this.style.display = 'none';
            // Zobrazí formulář pro hodnocení nápadu
            document.getElementById('ratingForm').style.display = 'block';
        });

        // Po odeslání formuláře pro hodnocení nápadu
        document.getElementById('submitRating').addEventListener('click', function() {
            // Skryje formulář pro hodnocení nápadu
            document.getElementById('ratingForm').style.display = 'none';
            // Zobrazí formulář pro výzkum
            document.getElementById('researchForm').style.display = 'block';
        });

        // Po odeslání formuláře pro výzkum
        document.getElementById('submitResearch').addEventListener('click', function() {
            // Aktualizujeme hodnoty v sekundárním okně
            let timeValue = document.getElementById('researchTime').value;
            let budgetValue = document.getElementById('researchBudget').value;
            updateTimeCounter(timeValue);
            updateBudgetCounter(budgetValue);

            // Skryje formulář pro výzkum
            document.getElementById('researchForm').style.display = 'none';
            // Zobrazí formulář pro design sprint
            document.getElementById('designSprintForm').style.display = 'block';
        });

        // Po odeslání formuláře pro design sprint
        document.getElementById('submitDesignSprint').addEventListener('click', function() {
            // Aktualizujeme hodnoty v sekundárním okně
            let designTimeValue = document.getElementById('designTime').value;
            let designBudgetValue = document.getElementById('designBudget').value;
            updateTimeCounter(designTimeValue);
            updateBudgetCounter(designBudgetValue);

            // Skryje formulář pro design sprint
            document.getElementById('designSprintForm').style.display = 'none';
            // Zobrazí formulář pro development
            document.getElementById('developmentForm').style.display = 'block';
        });

        // Po odeslání formuláře pro development
        document.getElementById('submitDevelopment').addEventListener('click', function() {
            // Aktualizujeme hodnoty v sekundárním okně
            let developmentTimeValue = document.getElementById('developmentTime').value;
            let developmentBudgetValue = document.getElementById('developmentBudget').value;
            updateTimeCounter(developmentTimeValue);
            updateBudgetCounter(developmentBudgetValue);

            // Kalkulace očekávaných výnosů
            let expectedRevenue = calculateExpectedRevenue();

            // Získání názvu nápadu a jména hráče
            let ideaName = document.getElementById('ideaName').value;
            let playerName = document.getElementById('playerName').value;

            // Přidání výsledků do leaderboardu
            addToLeaderboard(playerName, ideaName, expectedRevenue);

            // Skryje formulář pro development
            document.getElementById('developmentForm').style.display = 'none';
            // Zobrazí business case summary
            document.getElementById('businessCaseSummary').style.display = 'block';
            document.getElementById('totalTime').textContent = totalTime + ' MD';
            document.getElementById('totalBudget').textContent = totalBudget + '€';
            document.getElementById('expectedRevenue').textContent = expectedRevenue + '€';

            console.log('Business Case Summary displayed'); // Debugovací výpis

            // Zobrazí leaderboard
            document.getElementById('leaderboard').style.display = 'block';
        });

        // Posluchač události pro změnu hodnoty posuvníku pro čas výzkumu
        document.getElementById('researchTime').addEventListener('input', function() {
            document.getElementById('researchTimeLabel').textContent = this.value + ' MD';
        });

        // Posluchač události pro změnu hodnoty posuvníku pro rozpočet výzkumu
        document.getElementById('researchBudget').addEventListener('input', function() {
            document.getElementById('researchBudgetLabel').textContent = this.value + '€';
        });

        // Posluchač události pro změnu hodnoty posuvníku pro čas design sprintu
        document.getElementById('designTime').addEventListener('input', function() {
            document.getElementById('designTimeLabel').textContent = this.value + ' MD';
        });

        // Posluchač události pro změnu hodnoty posuvníku pro rozpočet design sprintu
        document.getElementById('designBudget').addEventListener('input', function() {
            document.getElementById('designBudgetLabel').textContent = this.value + '€';
        });

        // Posluchač události pro změnu hodnoty posuvníku pro čas developmentu
        document.getElementById('developmentTime').addEventListener('input', function() {
            document.getElementById('developmentTimeLabel').textContent = this.value + ' MD';
        });

        // Posluchač události pro změnu hodnoty posuvníku pro rozpočet developmentu
        document.getElementById('developmentBudget').addEventListener('input', function() {
            document.getElementById('developmentBudgetLabel').textContent = this.value + '€';
        });
    </script>
</body>
</html>
